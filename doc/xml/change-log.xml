<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE doc SYSTEM "doc.dtd">
<doc title="Change Log">
    <intro>
        <text></text>
    </intro>

    <changelog>
         <changelog-release date="XXXX-XX-XX" version="1.01dev" title="UNDER DEVELOPMENT">
             <release-feature-bullet-list>
                <release-feature><text></text></release-feature>
             </release-feature-bullet-list>
         </changelog-release>

         <changelog-release date="2016-04-14" version="1.00" title="New Repository Format and Configuration Scheme, Link Support">
             <release-feature-bullet-list>
                <release-feature>
                    <text><b>IMPORTANT NOTE</b>: This flag day release breaks compatibility with older versions of <backrest/>.  The manifest format, on-disk structure, configuration scheme, and the exe/path names have all changed.  You must create a new repository to hold backups for this version of <backrest/> and keep your older repository for a time in case you need to do a restore.  Restores from the prior repository will require the prior version of <backrest/> but because of name changes it is possible to have <id>1.00</id> and a prior version of <backrest/> installed at the same time.  See the notes below for more detailed information on what has changed.</text>
                </release-feature>
                <release-feature>
                    <text>Implemented a new configuration scheme which should be far simpler to use.  See the User Guide and Configuration Reference for details but for a simple configuration all options can now be placed in the <setting>stanza</setting> section. Options that are shared between stanzas can be placed in the <setting>[global]</setting> section.  More complex configurations can still make use of command sections though this should be a rare use case.</text>
                </release-feature>
                <release-feature>
                    <text>The <setting>repo-path</setting> option now always refers to the repository where backups and archive are stored, whether local or remote, so the <setting>repo-remote-path</setting> option has been removed.  The new <setting>spool-path</setting> option can be used to define a location for queueing WAL segments when archiving asynchronously.  A local repository is no longer required.</text>
                </release-feature>
                <release-feature>
                    <text>The default configuration filename is now <file>pgbackrest.conf</file> instead of <file>pg_backrest.conf</file>.  This was done for consistency with other naming changes but also to prevent old config files from being loaded accidentally when migrating to <id>1.00</id>.</text>
                </release-feature>
                <release-feature>
                    <text>The default repository name was changed from <path>/var/lib/backup</path> to <path>/var/lib/pgbackrest</path>.</text>
                </release-feature>
                <release-feature>
                    <text>Lock files are now stored in <path>/tmp/pgbackrest</path> by default. These days <path>/run/pgbackrest</path> is the preferred location but that would require init scripts which are not part of this release.  The <setting>lock-path</setting> option can be used to configure the lock directory.</text>
                </release-feature>
                <release-feature>
                    <text>Log files are now stored in <path>/var/log/pgbackrest</path> by default and no longer have the date appended so they can be managed with <id>logrotate</id>.  The <setting>log-path</setting> option can be used to configure the lock directory.</text>
                </release-feature>
                <release-feature>
                    <text>Executable filename changed from <file>pg_backrest</file> to <file>pgbackrest</file>.</text>
                </release-feature>
                <release-feature>
                    <text>All files and directories linked from PGDATA are now included in the backup.  By default links will be restored directly into PGDATA as files or directories.  The <setting>--link-all</setting> option can be used to restore all links to their original locations.  The <setting>--link-map</setting> option can be used to remap a link to a new location.</text>
                </release-feature>
                <release-feature>
                    <text>Removed <setting>--tablespace</setting> option and replaced with <setting>--tablespace-map-all</setting> option which should more clearly indicate its function.</text>
                </release-feature>
                <release-feature>
                    <text>Added <id>detail</id> log level which will output more information than <id>info</id> without being as verbose as <id>debug</id>.</text>
                </release-feature>
             </release-feature-bullet-list>
         </changelog-release>

        <changelog-release date="2016-04-06" version="0.92" title="Command-line Repository Path Fix">
            <release-feature-bullet-list>
                <release-feature><text>Fixed an issue where the master process was passing <setting>--repo-remote-path</setting> instead of <setting>--repo-path</setting> to the remote and causing the lock files to be created in the default repository directory (<path>/var/lib/backup</path>), generally ending in failure.  This was only an issue when <setting>--repo-remote-path</setting> was defined on the command line rather than in <file>pg_backrest.conf</file>.  <i>Reported by Jan Wieck</i>.</text></release-feature>
            </release-feature-bullet-list>
        </changelog-release>

        <changelog-release date="2016-03-22" version="0.91" title="Tablespace Bug Fix and Minor Enhancements">
            <release-feature-bullet-list>
                <release-feature>
                    <text><b>IMPORTANT BUG FIX FOR TABLESPACES</b>: A change to the repository format was accidentally introduced in 0.90 which means the on-disk backup was no longer a valid <postgres/> cluster when the backup contained tablespaces.  This only affected users who directly copied the backups to restore <postgres/> clusters rather than using the restore command.  However, the fix breaks compatibility with older backups that contain tablespaces no matter how they are being restored (<backrest/> will throw errors and refuse to restore).  New full backups should be taken immediately after installing version 0.91 for any clusters that contain tablespaces.  If older backups need to be restored then use a version of <backrest/> that matches the backup version. <i>Reported by Evan Benoit</i>.</text>
                </release-feature>
                <release-feature>
                    <text>Copy <file>global/pg_control</file> last during backups.</text>
                </release-feature>
                <release-feature>
                    <text>Write <id>.info</id> and <id>.manifest</id> files to temp before moving them to their final locations and fsync'ing.</text>
                </release-feature>
                <release-feature>
                    <text>Rename <setting>--no-start-stop</setting> option to <setting>--no-online</setting>.</text>
                </release-feature>
                <release-feature>
                    <text>Static source analysis using Perl-Critic, currently passes on gentle.</text>
                </release-feature>
            </release-feature-bullet-list>
        </changelog-release>

        <changelog-release date="2016-02-07" version="0.90" title="9.5 Support, Various Enhancements, and Minor Bug Fixes">
            <release-feature-bullet-list>
                <release-feature>
                    <text>Fixed an issue where specifying <setting>--no-archive-check</setting> would throw a configuration error.  <i>Reported by Jason O'Donnell</i>.</text>
                </release-feature>
                <release-feature>
                    <text>Fixed an issue where a temp WAL file left over after a well-timed system crash could cause the next <cmd>archive-push</cmd> to fail.</text>
                </release-feature>
                <release-feature>
                    <text>Fixed an issue where document generation failed because some OSs are not tolerant of having multiple installed versions of <postgres/>.  A separate VM is now created for each version.  Also added a sleep after database starts during document generation to ensure the database is running before the next command runs. <i>Reported by John Harvey</i>.</text>
                </release-feature>
                <release-feature>
                    <text>The <setting>retention-archive</setting> option can now be be safely set to less than backup retention (<setting>retention-full</setting> or <setting>retention-diff</setting>) without also specifying <setting>archive-copy=n</setting>.  The WAL required to make the backups that fall outside of archive retention consistent will be preserved in the archive.  However, in this case PITR will not be possible for the backups that fall outside of archive retention.</text>
                </release-feature>
                <release-feature>
                    <text>When backing up and restoring tablespaces <backrest/> only operates on the subdirectory created for the version of <postgres/> being run against.  Since multiple versions can live in a tablespace (especially during a binary upgrade) this prevents too many files from being copied during a backup and other versions possibly being wiped out during a restore.  This only applies to <postgres/> >= 9.0 -- prior versions of <postgres/> could not share a tablespace directory.</text>
                </release-feature>
                <release-feature>
                    <text>Generate an error when <setting>archive-check=y</setting> but <setting>archive_command</setting> does not execute <file>pg_backrest</file>. <i>Contributed by Jason O'Donnell</i>.</text>
                </release-feature>
                <release-feature>
                    <text>Improved error message when <setting>repo-path</setting> or <setting>repo-remote-path</setting> does not exist.</text>
                </release-feature>
                <release-feature>
                    <text>Added checks for <setting>--delta</setting> and <setting>--force</setting> restore options to ensure that the destination is a valid $PGDATA directory.  <backrest/> will check for the presence of <file>PG_VERSION</file> or <file>backup.manifest</file> (left over from an aborted restore).  If neither file is found then <setting>--delta</setting> and <setting>--force</setting> will be disabled but the restore will proceed unless there are files in the $PGDATA directory (or any tablespace directories) in which case the operation will be aborted.</text>
                </release-feature>
                <release-feature>
                    <text>When restore <setting>--set=latest</setting> (the default) the actual backup restored will be output to the log.</text>
                </release-feature>
                <release-feature>
                    <text>Support for <postgres/> 9.5 partial WAL segments and <setting>recovery_target_action</setting> setting. The <setting>archive_mode = 'always'</setting> setting is not yet supported.</text>
                </release-feature>
                <release-feature>
                    <text>Support for <setting>recovery_target = 'immediate'</setting> recovery setting introduced in <postgres/> 9.4.</text>
                </release-feature>
                <release-feature>
                    <text>The following tablespace checks have been added: paths or files in pg_tblspc, relative links in pg_tblspc, tablespaces in $PGDATA. All three will generate errors.</text>
                </release-feature>
            </release-feature-bullet-list>
        </changelog-release>

        <changelog-release date="2015-12-24" version="0.89" title="Timeout Bug Fix and Restore Read-Only Repositories">
            <release-feature-bullet-list>
                <release-feature>
                    <text>Fixed an issue where longer-running backups/restores would timeout when remote and threaded.  Keepalives are now used to make sure the remote for the main process does not timeout while the thread remotes do all the work.  The error message for timeouts was also improved to make debugging easier.</text>
                </release-feature>
                <release-feature>
                    <text>Allow restores to be performed on a read-only repository by using <setting>--no-lock</setting> and <setting>--log-level-file=off</setting>.  The <setting>--no-lock</setting> option can only be used with restores.</text>
                </release-feature>
                <release-feature>
                    <text>Minor styling changes, clarifications and rewording in the user guide.</text>
                </release-feature>
                <release-feature>
                    <text>The dev branch has been renamed to master and for the time being the master branch has renamed to release, though it will probably be removed at some point -- thus ends the gitflow experiment for <backrest/>.  It is recommended that any forks get re-forked and clones get re-cloned.</text>
                </release-feature>
            </release-feature-bullet-list>
        </changelog-release>

        <changelog-release date="2015-11-22" version="0.88" title="Documentation and Minor Bug Fixes">
            <release-feature-bullet-list>
                <release-feature>
                    <text>Added documentation in the user guide for delta restores, expiration, dedicated backup hosts, starting and stopping <backrest/>, and replication.</text>
                </release-feature>
                <release-feature>
                    <text>Fixed an issue where the <cmd>start</cmd>/<cmd>stop</cmd> commands required the <setting>--config</setting> option.</text>
                </release-feature>
                <release-feature>
                    <text>Fixed an issue where log files were being overwritten instead of appended.</text>
                </release-feature>
                <release-feature>
                    <text>Fixed an issue where <setting>backup-user</setting> was not optional.</text>
                </release-feature>
                <release-feature>
                    <text>Symlinks are no longer created in backup directories in the repository.  These symlinks could point virtually anywhere and potentially be dangerous.  Symlinks are still recreated during a restore.</text>
                </release-feature>
                <release-feature>
                    <text>Added better messaging for backup expiration.  Full and differential backup expirations are logged on a single line along with a list of all dependent backups expired.</text>
                </release-feature>
                <release-feature>
                    <text>Archive retention is automatically set to full backup retention if not explicitly configured.</text>
                </release-feature>
            </release-feature-bullet-list>
        </changelog-release>

        <changelog-release date="2015-10-28" version="0.87" title="Website and User Guide">
            <release-feature-bullet-list>
                <release-feature>
                    <text>Added a new user guide that covers <backrest/> basics and some advanced topics including PITR.  Much more to come, but it's a start.</text>
                </release-feature>
                <release-feature>
                    <text>The website, markdown, and command-line help are now all generated from the same XML source.</text>
                </release-feature>
                <release-feature>
                    <text>The <file>backup_label.old</file> and <file>recovery.done</file> files are now excluded from backups.</text>
                </release-feature>
            </release-feature-bullet-list>
        </changelog-release>

        <changelog-release date="2015-10-08" version="0.85" title="Start/Stop Commands and Minor Bug Fixes">
            <release-feature-bullet-list>
                <release-feature>
                    <text>Added new feature to allow all <backrest/> operations to be stopped or started using the <cmd>stop</cmd> and <cmd>start</cmd> commands.  This prevents any <backrest/> processes from running on a system where <postgres/> is shutdown or the system needs to be quiesced for some reason.</text>
                </release-feature>
                <release-feature>
                    <text>Removed dependency on <code>IO::String</code> module.</text>
                </release-feature>
                <release-feature>
                    <text>Fixed an issue where an error could be returned after a backup or restore completely successfully.</text>
                </release-feature>
                <release-feature>
                    <text>Fixed an issue where a resume would fail if temp files were left in the root backup directory when the backup failed.  This scenario was likely if the backup process got terminated during the copy phase.</text>
                </release-feature>
                <release-feature>
                    <text>Experimental support for <postgres/> 9.5 beta1.  This may break when the control version or WAL magic changes in future versions but will be updated in each <backrest/> release to keep pace.  All regression tests pass except for <setting>--target-resume</setting> tests (this functionality has changed in 9.5) and there is no testing yet for <file>.partial</file> WAL segments.</text>
                </release-feature>
            </release-feature-bullet-list>
        </changelog-release>

        <changelog-release date="2015-09-14" version="0.82" title="Refactoring, Command-line Help, and Minor Bug Fixes">
            <release-feature-bullet-list>
                <release-feature>
                    <text>Fixed an issue where resumed compressed backups were not preserving existing files.</text>
                </release-feature>
                <release-feature>
                    <text>Fixed an issue where resume and incr/diff would not ensure that the prior backup had the same compression and hardlink settings.</text>
                </release-feature>
                <release-feature>
                    <text>Fixed an issue where a cold backup using <setting>--no-start-stop</setting> could be started on a running <postgres/> cluster without <setting>--force</setting> specified.</text>
                </release-feature>
                <release-feature>
                    <text>Fixed an issue where a thread could be started even when none were requested.</text>
                </release-feature>
                <release-feature>
                    <text>Fixed an issue where the <backrest/> version number was not being updated in <file>backup.info</file> and <file>archive.info</file> after an upgrade/downgrade.</text>
                </release-feature>
                <release-feature>
                    <text>Fixed an issue where the <cmd>info</cmd> command was throwing an exception when the repository contained no stanzas.  <i>Reported by Stephen Frost</i>.</text>
                </release-feature>
                <release-feature>
                    <text>Fixed an issue where the <postgres/> <code>pg_stop_backup()</code> NOTICEs were being output to stderr.  <i>Reported by Stephen Frost</i>.</text>
                </release-feature>
                <release-feature>
                    <text>Renamed <setting>recovery-setting</setting> option and section to <setting>recovery-option</setting> to be more consistent with <backrest/> naming conventions.</text>
                </release-feature>
                <release-feature>
                    <text>Command-line help is now extracted from the same XML source that is used for the other documentation and includes much more detail.</text>
                </release-feature>
                <release-feature>
                    <text>Code cleanup and refactoring to standardize on patterns that have evolved over time.</text>
                </release-feature>
                <release-feature>
                    <text>Added dynamic module loading to speed up commands, especially asynchronous archiving.</text>
                </release-feature>
                <release-feature>
                    <text>Expiration tests are now synthetic rather than based on actual backups.  This will allow development of more advanced expiration features.</text>
                </release-feature>
                <release-feature>
                    <text>Experimental support for <postgres/> 9.5 alpha2.  This may break when the control version or WAL magic changes in future versions but will be updated in each <backrest/> release to keep pace.  All regression tests pass except for <setting>--target-resume</setting> tests (this functionality has changed in 9.5) and there is no testing yet for <file>.partial</file> WAL segments.</text>
                </release-feature>
            </release-feature-bullet-list>
        </changelog-release>

        <changelog-release date="2015-08-09" version="0.80" title="DBI Support, Stability, and Convenience Features">
            <release-feature-bullet-list>
                <release-feature>
                    <text>Fixed an issue that caused the formatted timestamp for both the oldest and newest backups to be reported as the current time by the <cmd>info</cmd> command.  Only <id>text</id> output was affected -- <id>json</id> output reported the correct epoch values.  <i>Reported by Michael Renner</i>.</text>
                </release-feature>
                <release-feature>
                    <text>Fixed protocol issue that was preventing ssh errors (especially on connection) from being logged.</text>
                </release-feature>
                <release-feature>
                    <text>Now using Perl <code>DBI</code> and <code>DBD::Pg</code> for connections to <postgres/> rather than <cmd>psql</cmd>.  The <setting>cmd-psql</setting> and <setting>cmd-psql-option</setting> settings have been removed and replaced with <setting>db-port</setting> and <setting>db-socket-path</setting>.  Follow the instructions in [Installation](USERGUIDE.md#installation) to install <code>DBD::Pg</code> on your operating system.</text>
                </release-feature>
                <release-feature>
                    <text>Add [stop-auto](USERGUIDE.md#stop-auto-key) option to allow failed backups to automatically be stopped when a new backup starts.</text>
                </release-feature>
                <release-feature>
                    <text>Add [db-timeout](USERGUIDE.md#db-timeout-key) option to limit the amount of time <backrest/> will wait for pg_start_backup() and pg_stop_backup() to return.</text>
                </release-feature>
                <release-feature>
                    <text>Remove <file>pg_control</file> file at the beginning of the restore and copy it back at the very end.  This prevents the possibility that a partial restore can be started by <postgres/>.</text>
                </release-feature>
                <release-feature>
                    <text>The repository is now created and updated with consistent directory and file modes.  By default <id>umask</id> is set to <id>0000</id> but this can be disabled with the <setting>neutral-umask</setting> setting.  <i>Reported by Cynthia Shang</i></text>
                </release-feature>
                <release-feature>
                    <text>Added checks to be sure the <setting>db-path</setting> setting is consistent with <setting>db-port</setting> by comparing the <setting>data_directory</setting> as reported by the cluster against the <setting>db-path</setting> setting and the version as reported by the cluster against the value read from <file>pg_control</file>.  The <setting>db-socket-path</setting> setting is checked to be sure it is an absolute path.</text>
                </release-feature>
                <release-feature>
                    <text>Experimental support for <postgres/> 9.5 alpha1.  This may break when the control version or WAL magic changes in future versions but will be updated in each <backrest/> release to keep pace.  All regression tests pass except for <setting>--target-resume</setting> tests (this functionality has changed in 9.5) and there is no testing yet for <file>.partial</file> WAL segments.</text>
                </release-feature>
                <release-feature>
                    <text>Major refactoring of the protocol layer to support future development.</text>
                </release-feature>
                <release-feature>
                    <text>Added vagrant test configurations for Ubuntu 14.04 and CentOS 7.</text>
                </release-feature>
                <release-feature>
                    <text>Split most of <file>README.md</file> out into <file>USERGUIDE.md</file> and <file>CHANGELOG.md</file> because it was becoming unwieldy.  Changed most references to <quote>database</quote> in the user guide to <quote>database cluster</quote> for clarity.</text>
                </release-feature>
            </release-feature-bullet-list>
        </changelog-release>

        <changelog-release date="2015-07-13" version="0.78" title="Remove CPAN Dependencies, Stability Improvements">
            <release-feature-bullet-list>
                <release-feature>
                    <text>Removed dependency on CPAN packages for multi-threaded operation.  While it might not be a bad idea to update the <code>threads</code> and <code>Thread::Queue</code> packages, it is no longer necessary.</text>
                </release-feature>
                <release-feature>
                    <text>Added vagrant test configurations for Ubuntu 12.04 and CentOS 6.</text>
                </release-feature>
                <release-feature>
                    <text>Modified wait backoff to use a Fibonacci rather than geometric sequence.  This will make wait time grow less aggressively while still giving reasonable values.</text>
                </release-feature>
                <release-feature>
                    <text>More options for regression tests and improved code to run in a variety of environments.</text>
                </release-feature>
            </release-feature-bullet-list>
        </changelog-release>

        <changelog-release date="2015-06-30" version="0.77" title="CentOS/RHEL 6 Support and Protocol Improvements">
            <release-feature-bullet-list>
                <release-feature>
                    <text>Removed <file>pg_backrest_remote</file> and added the functionality to <file>pg_backrest</file> as the <cmd>remote</cmd> command.</text>
                </release-feature>
                <release-feature>
                    <text>Added file and directory syncs to the <code>File</code> object for additional safety during backup/restore and archiving.  <i>Suggested by Andres Freund</i>.</text>
                </release-feature>
                <release-feature>
                    <text>Support for Perl 5.10.1 and OpenSSH 5.3 which are default for CentOS/RHEL 6.  <i>Reported by Eric Radman.</i></text>
                </release-feature>
                <release-feature>
                    <text>Improved error message when backup is run without <setting>archive_command</setting> set and without <setting>--no-archive-check</setting> specified.  <i>Reported by Eric Radman</i>.</text>
                </release-feature>
                <release-feature>
                    <text>Moved version number out of the <file>VERSION</file> file to <file>Version.pm</file> to better support packaging.  <i>Suggested by Michael Renner</i>.</text>
                </release-feature>
                <release-feature>
                    <text>Replaced <code>IPC::System::Simple</code> and <code>Net::OpenSSH</code> with <code>IPC::Open3</code> to eliminate CPAN dependency for multiple operating systems.</text>
                </release-feature>
            </release-feature-bullet-list>
        </changelog-release>

        <changelog-release date="2015-06-14" version="0.75" title="New Repository Format, Info Command and Experimental 9.5 Support">
            <release-feature-bullet-list>
                <release-feature>
                    <text><b>IMPORTANT NOTE</b>: This flag day release breaks compatibility with older versions of <backrest/>.  The manifest format, on-disk structure, and the binary names have all changed.  You must create a new repository to hold backups for this version of <backrest/> and keep your older repository for a time in case you need to do a restore.  The <file>pg_backrest.conf</file> file has not changed but you'll need to change any references to <file>pg_backrest.pl</file> in cron (or elsewhere) to <file>pg_backrest</file> (without the <file>.pl</file> extension).</text>
                </release-feature>
                <release-feature>
                    <text>Add <cmd>info</cmd> command.</text>
                </release-feature>
                <release-feature>
                    <text>More efficient file ordering for <cmd>backup</cmd>.  Files are copied in descending size order so a single thread does not end up copying a large file at the end.  This had already been implemented for <cmd>restore</cmd>.</text>
                </release-feature>
                <release-feature>
                    <text>Logging now uses unbuffered output.  This should make log files that are being written by multiple threads less chaotic.  <i>Suggested by Michael Renner</i>.</text>
                </release-feature>
                <release-feature>
                    <text>Experimental support for <postgres/> 9.5.  This may break when the control version or WAL magic changes but will be updated in each release.</text>
                </release-feature>
            </release-feature-bullet-list>
        </changelog-release>

        <changelog-release date="2015-06-01" version="0.70" title="Stability Improvements for Archiving, Improved Logging and Help">
            <release-feature-bullet-list>
                <release-feature>
                    <text>Fixed an issue where <cmd>archive-copy</cmd> would fail on an incr/diff backup when <setting>hardlink=n</setting>.  In this case the <path>pg_xlog</path> path does not already exist and must be created. <i>Reported by Michael Renner</i></text>
                </release-feature>
                <release-feature>
                    <text>Allow duplicate WAL segments to be archived when the checksum matches.  This is necessary for some recovery scenarios.</text>
                </release-feature>
                <release-feature>
                    <text>Allow comments/disabling in <file>pg_backrest.conf</file> using the <id>#</id> character.  Only <id>#</id> characters in the forst character of the line are honored.  <i>Suggested by Michael Renner</i>.</text>
                </release-feature>
                <release-feature>
                    <text>Better logging before <id>pg_start_backup()</id> to make it clear when the backup is waiting on a checkpoint.  <i>Suggested by Michael Renner</i>.</text>
                </release-feature>
                <release-feature>
                    <text>Various command behavior, help and logging fixes.  <i>Reported by Michael Renner</i>.</text>
                </release-feature>
                <release-feature>
                    <text>Fixed an issue in async archiving where <cmd>archive-push</cmd> was not properly returning 0 when <setting>archive-max-mb</setting> was reached and moved the async check after transfer to avoid having to remove the stop file twice.  Also added unit tests for this case and improved error messages to make it clearer to the user what went wrong.  <i>Reported by Michael Renner</i>.</text>
                </release-feature>
                <release-feature>
                    <text>Fixed a locking issue that could allow multiple operations of the same type against a single stanza.  This appeared to be benign in terms of data integrity but caused spurious errors while archiving and could lead to errors in backup/restore. <i>Reported by Michael Renner</i>.</text>
                </release-feature>
                <release-feature>
                    <text>Replaced <code>JSON</code> module with <code>JSON::PP</code> which ships with core Perl.</text>
                </release-feature>
            </release-feature-bullet-list>
        </changelog-release>

        <changelog-release date="2015-05-11" version="0.65" title="Improved Resume and Restore Logging, Compact Restores">
            <release-feature-bullet-list>
                <release-feature>
                    <text>Better resume support.  Resumed files are checked to be sure they have not been modified and the manifest is saved more often to preserve checksums as the backup progresses.  More unit tests to verify each resume case.</text>
                </release-feature>
                <release-feature>
                    <text>Resume is now optional.  Use the <setting>resume</setting> setting or <param>--no-resume</param> from the command line to disable.</text>
                </release-feature>
                <release-feature>
                    <text>More info messages during restore.  Previously, most of the restore messages were debug level so not a lot was output in the log.</text>
                </release-feature>
                <release-feature>
                    <text>Fixed an issue where an absolute path was not written into recovery.conf when the restore was run with a relative path.</text>
                </release-feature>
                <release-feature>
                    <text>Added <setting>tablespace</setting> setting to allow tablespaces to be restored into the <path>pg_tblspc</path> path.  This produces compact restores that are convenient for development, staging, etc.  Currently these restores cannot be backed up as <backrest/> expects only links in the <path>pg_tblspc</path> path.</text>
                </release-feature>
            </release-feature-bullet-list>
        </changelog-release>

        <changelog-release date="2015-04-21" version="0.61" title="Bug Fix for Uncompressed Remote Destination">
            <release-feature-bullet-list>
                <release-feature>
                    <text>Fixed a buffering error that could occur on large, highly-compressible files when copying to an uncompressed remote destination.  The error was detected in the decompression code and resulted in a failed backup rather than corruption so it should not affect successful backups made with previous versions.</text>
                </release-feature>
            </release-feature-bullet-list>
        </changelog-release>

        <changelog-release date="2015-04-19" version="0.60" title="Better Version Support and WAL Improvements">
            <release-feature-bullet-list>
                <release-feature>
                    <text>Pushing duplicate WAL now generates an error.  This worked before only if checksums were disabled.</text>
                </release-feature>
                <release-feature>
                    <text>Database System IDs are used to make sure that all WAL in an archive matches up.  This should help prevent misconfigurations that send WAL from multiple clusters to the same archive.</text>
                </release-feature>
                <release-feature>
                    <text>Regression tests working back to <postgres/> 8.3.</text>
                </release-feature>
                <release-feature>
                    <text>Improved threading model by starting threads early and terminating them late.</text>
                </release-feature>
            </release-feature-bullet-list>
        </changelog-release>

        <changelog-release date="2015-03-25" version="0.50" title="Restore and Much More">
            <release-feature-bullet-list>
                <release-feature>
                    <text>Added restore functionality.</text>
                </release-feature>
                <release-feature>
                    <text>All options can now be set on the command-line making <file>pg_backrest.conf</file> optional.</text>
                </release-feature>
                <release-feature>
                    <text>De/compression is now performed without threads and checksum/size is calculated in stream.  That means file checksums are no longer optional.</text>
                </release-feature>
                <release-feature>
                    <text>Added option <param>--no-start-stop</param> to allow backups when Postgres is shut down.  If <file>postmaster.pid</file> is present then <param>--force</param> is required to make the backup run (though if Postgres is running an inconsistent backup will likely be created).  This option was added primarily for the purpose of unit testing, but there may be applications in the real world as well.</text>
                </release-feature>
                <release-feature>
                    <text>Fixed broken checksums and now they work with normal and resumed backups.  Finally realized that checksums and checksum deltas should be functionally separated and this simplified a number of things.  Issue #28 has been created for checksum deltas.</text>
                </release-feature>
                <release-feature>
                    <text>Fixed an issue where a backup could be resumed from an aborted backup that didn't have the same type and prior backup.</text>
                </release-feature>
                <release-feature>
                    <text>Removed dependency on <code>Moose</code>.  It wasn't being used extensively and makes for longer startup times.</text>
                </release-feature>
                <release-feature>
                    <text>Checksum for <file>backup.manifest</file> to detect a corrupted/modified manifest.</text>
                </release-feature>
                <release-feature>
                    <text>Link <path>latest</path> always points to the last backup.  This has been added for convenience and to make restores simpler.</text>
                </release-feature>
                <release-feature>
                    <text>More comprehensive unit tests in all areas.</text>
                </release-feature>
            </release-feature-bullet-list>
        </changelog-release>

        <changelog-release date="2014-10-05" version="0.30" title="Core Restructuring and Unit Tests">
            <release-feature-bullet-list>
                <release-feature>
                    <text>Complete rewrite of <code>BackRest::File</code> module to use a custom protocol for remote operations and Perl native GZIP and SHA operations.  Compression is performed in threads rather than forked processes.</text>
                </release-feature>
                <release-feature>
                    <text>Fairly comprehensive unit tests for all the basic operations.  More work to be done here for sure, but then there is always more work to be done on unit tests.</text>
                </release-feature>
                <release-feature>
                    <text>Removed dependency on <code>Storable</code> and replaced with a custom ini file implementation.</text>
                </release-feature>
                <release-feature>
                    <text>Added much needed documentation</text>
                </release-feature>
                <release-feature>
                    <text>Numerous other changes that can only be identified with a diff.</text>
                </release-feature>
            </release-feature-bullet-list>
        </changelog-release>

        <changelog-release date="2014-05-13" version="0.19" title="Improved Error Reporting/Handling">
            <release-feature-bullet-list>
                <release-feature>
                    <text>Working on improving error handling in the <code>File</code> object.  This is not complete, but works well enough to find a few errors that have been causing us problems (notably, find is occasionally failing building the archive async manifest when system is under load).</text>
                </release-feature>
                <release-feature>
                    <text>Found and squashed a nasty bug where <code>file_copy()</code> was defaulted to ignore errors.  There was also an issue in <code>file_exists()</code> that was causing the test to fail when the file actually did exist.  Together they could have resulted in a corrupt backup with no errors, though it is very unlikely.</text>
                </release-feature>
            </release-feature-bullet-list>
        </changelog-release>

        <changelog-release date="2014-04-13" version="0.18" title="Return Soft Error When Archive Missing">
            <release-feature-bullet-list>
                <release-feature>
                    <text>The <cmd>archive-get</cmd> command returns a 1 when the archive file is missing to differentiate from hard errors (ssh connection failure, file copy error, etc.)  This lets <postgres/> know that that the archive stream has terminated normally.  However, this does not take into account possible holes in the archive stream.</text>
                </release-feature>
            </release-feature-bullet-list>
        </changelog-release>

        <changelog-release date="2014-04-03" version="0.17" title="Warn When Archive Directories Cannot Be Deleted">
            <release-feature-bullet-list>
                <release-feature>
                    <text>If an archive directory which should be empty could not be deleted backrest was throwing an error.  There's a good fix for that coming, but for the time being it has been changed to a warning so processing can continue.  This was impacting backups as sometimes the final archive file would not get pushed if the first archive file had been in a different directory (plus some bad luck).</text>
                </release-feature>
            </release-feature-bullet-list>
        </changelog-release>

        <changelog-release date="2014-04-01" version="0.16" title="RequestTTY=yes for SSH Sessions">
            <release-feature-bullet-list>
                <release-feature>
                    <text>Added <setting>RequestTTY=yes</setting> to ssh sessions.  Hoping this will prevent random lockups.</text>
                </release-feature>
            </release-feature-bullet-list>
        </changelog-release>

        <changelog-release date="2014-03-29" version="0.15" title="Added archive-get">
            <release-feature-bullet-list>
                <release-feature>
                    <text>Added <cmd>archive-get</cmd> functionality to aid in restores.</text>
                </release-feature>
                <release-feature>
                    <text>Added option to force a checkpoint when starting the backup, <setting>start-fast=y</setting>.</text>
                </release-feature>
            </release-feature-bullet-list>
        </changelog-release>

        <changelog-release date="2014-03-26" version="0.11" title="Minor Fixes">
            <release-feature-bullet-list>
                <release-feature>
                    <text>Removed <setting>master_stderr_discard</setting> option on database SSH connections.  There have been occasional lockups and they could be related to issues originally seen in the file code.</text>
                </release-feature>
                <release-feature>
                    <text>Changed lock file conflicts on <cmd>backup</cmd> and <cmd>expire</cmd> commands to <id>ERROR</id>.  They were set to <id>DEBUG</id> due to a copy-and-paste from the archive locks.</text>
                </release-feature>
            </release-feature-bullet-list>
        </changelog-release>

        <changelog-release date="2014-03-05" version="0.10" title="Backup and Archiving are Functional">
            <release-feature-bullet-list>
                <release-feature>
                    <text>No restore functionality, but the backup directories are consistent <postgres/> data directories.  You'll need to either uncompress the files or turn off compression in the backup.  Uncompressed backups on a ZFS (or similar) filesystem are a good option because backups can be restored locally via a snapshot to create logical backups or do spot data recovery.</text>
                </release-feature>
                <release-feature>
                    <text>Archiving is single-threaded.  This has not posed an issue on our multi-terabyte databases with heavy write volume.  Recommend a large WAL volume or to use the async option with a large volume nearby.</text>
                </release-feature>
                <release-feature>
                    <text>Backups are multi-threaded, but the <code>Net::OpenSSH</code> library does not appear to be 100% thread-safe so it will very occasionally lock up on a thread.  There is an overall process timeout that resolves this issue by killing the process.  Yes, very ugly.</text>
                </release-feature>
                <release-feature>
                    <text>Checksums are lost on any resumed backup. Only the final backup will record checksum on multiple resumes.  Checksums from previous backups are correctly recorded and a full backup will reset everything.</text>
                </release-feature>
                <release-feature>
                    <text>The <file>backup.manifest</file> is being written as <code>Storable</code> because <code>Config::IniFile</code> does not seem to handle large files well.  Would definitely like to save these as human-readable text.</text>
                </release-feature>
                <release-feature>
                    <text>Absolutely no documentation (outside the code).  Well, excepting these release notes.</text>
                </release-feature>
            </release-feature-bullet-list>
        </changelog-release>
    </changelog>
</doc>
